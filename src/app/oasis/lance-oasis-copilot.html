<!-- COPILOT PAGE -->
<div id="copilot-page" class="hidden">
  <header
    class="bg-white border-b border-slate-200 px-8 py-4 sticky top-0 z-20 backdrop-blur-lg bg-opacity-95"
  >
    <div class="flex justify-between items-center">
      <!-- Left: Back + Patient Info -->
      <div class="flex items-center space-x-6">
        <button
          (click)="showDashboard()"
          class="text-slate-400 hover:text-slate-600 transition-colors"
        >
          <ion-icon name="chevron-back-outline" class="text-2xl"></ion-icon>
        </button>
        <div class="flex items-center space-x-3">
          <div class="text-xs font-semibold text-indigo-600 bg-indigo-50 px-2 py-1 rounded">
            LANCE AI
          </div>
          <div class="w-px h-8 bg-slate-200"></div>
          <div>
            <div class="flex items-center space-x-2">
              <h1 class="text-base font-semibold text-slate-900">Maria Garcia</h1>
              <button
                (click)="quickEligibilityCheck($event)"
                class="text-xs font-medium text-emerald-600 hover:text-emerald-700 bg-emerald-50 hover:bg-emerald-100 px-2 py-0.5 rounded transition-colors flex items-center space-x-1"
              >
                <ion-icon name="shield-checkmark-outline" class="text-sm"></ion-icon>
                <span>Check Eligibility</span>
              </button>
            </div>
            <p class="text-xs text-slate-500">MRN-98765 â€¢ Start of Care</p>
          </div>
        </div>
      </div>

      <!-- Right: Stats + Actions -->
      <div class="flex items-center space-x-6">
        <!-- Progress -->
        <div class="flex items-center space-x-3">
          <div class="text-right">
            <p class="text-xs text-slate-500">Completion</p>
            <p id="progress-text" class="text-sm font-semibold text-slate-900">15%</p>
          </div>
          <div class="w-20 bg-slate-100 rounded-full h-1.5">
            <div
              id="progress-bar"
              class="bg-indigo-600 h-1.5 rounded-full transition-all"
              style="width: 15%"
            ></div>
          </div>
        </div>

        <div class="w-px h-8 bg-slate-200"></div>

        <!-- PDGM -->
        <div class="text-right">
          <p class="text-xs text-slate-500">Est. Payment</p>
          <p id="pdgm-value" class="text-sm font-semibold text-slate-900 transition-all">
            $2,875.50
          </p>
        </div>

        <div class="w-px h-8 bg-slate-200"></div>

        <!-- Actions -->
        <button
          (click)="validateForm()"
          class="text-sm font-medium text-amber-600 hover:text-amber-700 transition-colors flex items-center space-x-1"
        >
          <ion-icon name="alert-circle-outline" class="text-lg"></ion-icon>
          <span>Validate Form</span>
        </button>

        <button
          (click)="resetDemo()"
          class="text-sm font-medium text-slate-600 hover:text-slate-900 transition-colors flex items-center space-x-1"
        >
          <ion-icon name="refresh-outline" class="text-lg"></ion-icon>
          <span>Reset</span>
        </button>

        <button
          (click)="showModal('export-modal')"
          class="text-sm font-medium text-indigo-600 hover:text-indigo-700 transition-colors"
        >
          Finalize & Export
        </button>
      </div>
    </div>
  </header>

  <main class="grid grid-cols-12 h-[calc(100vh-73px)]">
    <!-- LEFT COLUMN (AI Recommendations) -->
    <aside
      class="col-span-4 bg-white rounded-2xl border border-slate-200 overflow-hidden shadow-sm"
    >
      <div class="px-6 py-4 border-b border-slate-100">
        <h2 class="text-sm font-semibold text-slate-900">AI Recommendations</h2>
        <p class="text-xs text-slate-500 mt-0.5">Review and accept suggestions</p>
      </div>

      <!-- Payment Optimization Alert Banner (Clean & Factual) -->
      <div class="bg-blue-50 border-b border-blue-100 px-6 py-4">
        <div class="flex items-start space-x-3">
          <div class="bg-blue-500 rounded-full p-1 flex-shrink-0 mt-0.5">
            <ion-icon name="information" class="text-white text-sm"></ion-icon>
          </div>
          <div class="flex-1">
            <h3 class="text-xs font-semibold text-blue-900 mb-1">High-Value Comorbidity</h3>
            <p class="text-xs text-blue-700 leading-relaxed mb-2">
              COPD (J44.1) qualifies for High Comorbidity tier.
            </p>
            <div class="flex items-center justify-between text-xs">
              <span class="text-blue-600">Tier: None â†’ High</span>
              <span class="text-blue-900 font-semibold">+$287</span>
            </div>
          </div>
        </div>
      </div>

      <div
        id="recommendations-list"
        class="overflow-y-auto h-[calc(100%-210px)] px-6 py-4 space-y-3"
      >
        <!-- ICD-10 Primary Diagnosis (OASIS-E1: I8000) -->
        <div
          class="recommendation-card border border-slate-200 bg-white rounded-xl p-4 cursor-pointer hover:border-slate-300 hover:shadow-sm transition-all"
          (click)="selectRecommendation($event, 'I8000-primary', 'discharge-doc')"
          data-form-id="form-I8000-primary-answer"
        >
          <div class="flex justify-between items-start mb-3">
            <div class="flex-1">
              <p class="text-xs font-medium text-slate-500 mb-1">Primary Diagnosis</p>
              <p class="text-sm font-semibold text-slate-900">S72.001D</p>
            </div>
            <span class="text-xs font-medium text-emerald-600">95%</span>
          </div>

          <p class="text-xs text-slate-600 mb-3 leading-relaxed">
            Hip fracture aftercare, requires skilled PT/OT services
          </p>

          <div
            class="flex items-center justify-between text-xs mb-3 pb-3 border-b border-slate-100"
          >
            <span class="text-slate-500">PDGM: MS-Rehab</span>
            <span class="text-slate-500">ðŸ“„ Discharge, Visit</span>
          </div>

          <div class="flex space-x-2">
            <button
              (click)="
                acceptRecommendation(
                  $event,
                  'I8000-primary',
                  'S72.001D - Fracture of neck of right femur, subsequent encounter',
                  true,
                  25
                )
              "
              class="flex-1 bg-indigo-600 hover:bg-indigo-700 text-white text-xs font-medium py-2 rounded-lg transition-colors"
            >
              Accept
            </button>
            <button
              (click)="rejectRecommendation($event)"
              class="px-3 text-slate-400 hover:text-slate-600 text-xs font-medium transition-colors"
            >
              Reject
            </button>
          </div>
        </div>

        <!-- Comorbidity - High Value! -->
        <div
          class="recommendation-card border border-emerald-200 bg-emerald-50 rounded-xl p-4 cursor-pointer hover:border-emerald-300 hover:shadow-sm transition-all"
          (click)="selectRecommendation($event, 'I8000-comorbidity', 'discharge-doc')"
          data-form-id="form-I8000-other-diagnoses-container"
        >
          <div class="flex justify-between items-start mb-3">
            <div class="flex-1">
              <div class="flex items-center space-x-2 mb-1">
                <p class="text-xs font-medium text-slate-500">Other Diagnosis</p>
                <span class="px-1.5 py-0.5 text-xs bg-emerald-600 text-white rounded font-medium"
                  >High Value</span
                >
              </div>
              <p class="text-sm font-semibold text-slate-900">J44.1</p>
            </div>
            <span class="text-xs font-medium text-emerald-600">100%</span>
          </div>

          <p class="text-xs text-slate-600 mb-3 leading-relaxed">
            COPD with exacerbation, patient on oxygen therapy at home
          </p>

          <div
            class="flex items-center justify-between text-xs mb-3 pb-3 border-b border-emerald-200"
          >
            <span class="text-emerald-700">High Comorbidity</span>
            <span class="text-slate-500">ðŸ“„ Discharge</span>
          </div>

          <div class="flex space-x-2">
            <button
              (click)="
                acceptRecommendation(
                  $event,
                  'I8000-comorbidity',
                  'J44.1 - COPD with acute exacerbation',
                  true,
                  30
                )
              "
              class="flex-1 bg-indigo-600 hover:bg-indigo-700 text-white text-xs font-medium py-2 rounded-lg transition-colors"
            >
              Accept
            </button>
            <button
              (click)="rejectRecommendation($event)"
              class="px-3 text-slate-400 hover:text-slate-600 text-xs font-medium transition-colors"
            >
              Reject
            </button>
          </div>
        </div>

        <!-- Additional Comorbidity - Diabetes -->
        <div
          class="recommendation-card border border-slate-200 bg-white rounded-xl p-4 cursor-pointer hover:border-slate-300 hover:shadow-sm transition-all"
          (click)="selectRecommendation($event, 'I8000-diabetes', 'discharge-doc')"
          data-form-id="form-I8000-other-diagnoses-container"
        >
          <div class="flex justify-between items-start mb-3">
            <div class="flex-1">
              <p class="text-xs font-medium text-slate-500 mb-1">Other Diagnosis</p>
              <p class="text-sm font-semibold text-slate-900">E11.9</p>
            </div>
            <span class="text-xs font-medium text-emerald-600">98%</span>
          </div>

          <p class="text-xs text-slate-600 mb-3 leading-relaxed">
            Type 2 diabetes without complications
          </p>

          <div
            class="flex items-center justify-between text-xs mb-3 pb-3 border-b border-slate-100"
          >
            <span class="text-slate-500">Low Comorbidity</span>
            <span class="text-slate-500">ðŸ“„ Discharge</span>
          </div>

          <div class="flex space-x-2">
            <button
              (click)="
                acceptRecommendation(
                  $event,
                  'I8000-diabetes',
                  'E11.9 - Type 2 diabetes mellitus',
                  false,
                  5
                )
              "
              class="flex-1 bg-indigo-600 hover:bg-indigo-700 text-white text-xs font-medium py-2 rounded-lg transition-colors"
            >
              Accept
            </button>
            <button
              (click)="rejectRecommendation($event)"
              class="px-3 text-slate-400 hover:text-slate-600 text-xs font-medium transition-colors"
            >
              Reject
            </button>
          </div>
        </div>

        <!-- Additional Diagnosis - HTN -->
        <div
          class="recommendation-card border border-slate-200 bg-white rounded-xl p-4 cursor-pointer hover:border-slate-300 hover:shadow-sm transition-all"
          (click)="selectRecommendation($event, 'I8000-htn', 'discharge-doc')"
          data-form-id="form-I8000-other-diagnoses-container"
        >
          <div class="flex justify-between items-start mb-3">
            <div class="flex-1">
              <p class="text-xs font-medium text-slate-500 mb-1">Other Diagnosis</p>
              <p class="text-sm font-semibold text-slate-900">I10</p>
            </div>
            <span class="text-xs font-medium text-emerald-600">92%</span>
          </div>

          <p class="text-xs text-slate-600 mb-3 leading-relaxed">
            Essential hypertension, controlled
          </p>

          <div
            class="flex items-center justify-between text-xs mb-3 pb-3 border-b border-slate-100"
          >
            <span class="text-slate-500">No adjustment</span>
            <span class="text-slate-500">ðŸ“„ Discharge</span>
          </div>

          <div class="flex space-x-2">
            <button
              (click)="
                acceptRecommendation($event, 'I8000-htn', 'I10 - Essential hypertension', false, 5)
              "
              class="flex-1 bg-indigo-600 hover:bg-indigo-700 text-white text-xs font-medium py-2 rounded-lg transition-colors"
            >
              Accept
            </button>
            <button
              (click)="rejectRecommendation($event)"
              class="px-3 text-slate-400 hover:text-slate-600 text-xs font-medium transition-colors"
            >
              Reject
            </button>
          </div>
        </div>

        <!-- GG Self-Care - Eating -->
        <div
          class="recommendation-card border border-slate-200 bg-white rounded-xl p-4 cursor-pointer hover:border-slate-300 hover:shadow-sm transition-all"
          (click)="selectRecommendation($event, 'GG0130A', 'visit-doc')"
          data-form-id="GG0130A-select"
        >
          <div class="flex justify-between items-start mb-3">
            <div class="flex-1">
              <p class="text-xs font-medium text-slate-500 mb-1">GG0130A. Eating</p>
              <p class="text-sm font-semibold text-slate-900">06 - Independent</p>
            </div>
            <span class="text-xs font-medium text-emerald-600">85%</span>
          </div>

          <p class="text-xs text-slate-600 mb-3 leading-relaxed">
            Patient able to feed self without assistance
          </p>

          <div
            class="flex items-center justify-between text-xs mb-3 pb-3 border-b border-slate-100"
          >
            <span class="text-slate-500">Self-Care</span>
            <span class="text-slate-500">ðŸ“‹ Visit Note</span>
          </div>

          <div class="flex space-x-2">
            <button
              (click)="acceptGGRecommendation($event, 'GG0130A', '06')"
              class="flex-1 bg-indigo-600 hover:bg-indigo-700 text-white text-xs font-medium py-2 rounded-lg transition-colors"
            >
              Accept
            </button>
            <button
              (click)="rejectRecommendation($event)"
              class="px-3 text-slate-400 hover:text-slate-600 text-xs font-medium transition-colors"
            >
              Reject
            </button>
          </div>
        </div>

        <!-- GG Self-Care (OASIS-E1) - Bathing -->
        <div
          class="recommendation-card border border-slate-200 bg-white rounded-xl p-4 cursor-pointer hover:border-slate-300 hover:shadow-sm transition-all"
          (click)="selectRecommendation($event, 'GG0130E', 'visit-doc')"
          data-form-id="form-GG0130E-answer"
        >
          <div class="flex justify-between items-start mb-3">
            <div class="flex-1">
              <p class="text-xs font-medium text-slate-500 mb-1">GG0130E. Shower/Bathe Self</p>
              <p class="text-sm font-semibold text-slate-900">03 - Partial assistance</p>
            </div>
            <span class="text-xs font-medium text-yellow-600">72%</span>
          </div>

          <p class="text-xs text-slate-600 mb-3 leading-relaxed">
            Requires hands-on assistance to wash back and lower extremities
          </p>

          <div
            class="flex items-center justify-between text-xs mb-3 pb-3 border-b border-slate-100"
          >
            <span class="text-slate-500">Self-Care</span>
            <span class="text-slate-500">ðŸ“‹ Visit Note</span>
          </div>

          <div class="flex space-x-2">
            <button
              (click)="
                acceptRecommendation(
                  $event,
                  'GG0130E',
                  '03 - Partial/moderate assistance',
                  false,
                  10
                )
              "
              class="flex-1 bg-indigo-600 hover:bg-indigo-700 text-white text-xs font-medium py-2 rounded-lg transition-colors"
            >
              Accept
            </button>
            <button
              (click)="rejectRecommendation($event)"
              class="px-3 text-slate-400 hover:text-slate-600 text-xs font-medium transition-colors"
            >
              Reject
            </button>
          </div>
        </div>

        <!-- GG Self-Care - Upper Body Dressing -->
        <div
          class="recommendation-card border border-slate-200 bg-white rounded-xl p-4 cursor-pointer hover:border-slate-300 hover:shadow-sm transition-all"
          (click)="selectRecommendation($event, 'GG0130F', 'visit-doc')"
          data-form-id="GG0130F-select"
        >
          <div class="flex justify-between items-start mb-3">
            <div class="flex-1">
              <p class="text-xs font-medium text-slate-500 mb-1">GG0130F. Upper Body Dressing</p>
              <p class="text-sm font-semibold text-slate-900">06 - Independent</p>
            </div>
            <span class="text-xs font-medium text-emerald-600">78%</span>
          </div>

          <p class="text-xs text-slate-600 mb-3 leading-relaxed">
            Patient able to dress upper body without assistance
          </p>

          <div
            class="flex items-center justify-between text-xs mb-3 pb-3 border-b border-slate-100"
          >
            <span class="text-slate-500">Self-Care</span>
            <span class="text-slate-500">ðŸ“‹ Visit Note</span>
          </div>

          <div class="flex space-x-2">
            <button
              (click)="acceptGGRecommendation($event, 'GG0130F', '06')"
              class="flex-1 bg-indigo-600 hover:bg-indigo-700 text-white text-xs font-medium py-2 rounded-lg transition-colors"
            >
              Accept
            </button>
            <button
              (click)="rejectRecommendation($event)"
              class="px-3 text-slate-400 hover:text-slate-600 text-xs font-medium transition-colors"
            >
              Reject
            </button>
          </div>
        </div>

        <!-- GG Self-Care - Lower Body Dressing -->
        <div
          class="recommendation-card border border-slate-200 bg-white rounded-xl p-4 cursor-pointer hover:border-slate-300 hover:shadow-sm transition-all"
          (click)="selectRecommendation($event, 'GG0130G', 'visit-doc')"
          data-form-id="GG0130G-select"
        >
          <div class="flex justify-between items-start mb-3">
            <div class="flex-1">
              <p class="text-xs font-medium text-slate-500 mb-1">GG0130G. Lower Body Dressing</p>
              <p class="text-sm font-semibold text-slate-900">04 - Supervision</p>
            </div>
            <span class="text-xs font-medium text-yellow-600">75%</span>
          </div>

          <p class="text-xs text-slate-600 mb-3 leading-relaxed">
            Requires supervision for balance when dressing
          </p>

          <div
            class="flex items-center justify-between text-xs mb-3 pb-3 border-b border-slate-100"
          >
            <span class="text-slate-500">Self-Care</span>
            <span class="text-slate-500">ðŸ“‹ Visit Note</span>
          </div>

          <div class="flex space-x-2">
            <button
              (click)="acceptGGRecommendation($event, 'GG0130G', '04')"
              class="flex-1 bg-indigo-600 hover:bg-indigo-700 text-white text-xs font-medium py-2 rounded-lg transition-colors"
            >
              Accept
            </button>
            <button
              (click)="rejectRecommendation($event)"
              class="px-3 text-slate-400 hover:text-slate-600 text-xs font-medium transition-colors"
            >
              Reject
            </button>
          </div>
        </div>

        <!-- GG Mobility (OASIS-E1) - Walk 10 feet -->
        <div
          class="recommendation-card border border-slate-200 bg-white rounded-xl p-4 cursor-pointer hover:border-slate-300 hover:shadow-sm transition-all"
          (click)="selectRecommendation($event, 'GG0170C', 'visit-doc')"
          data-form-id="form-GG0170C-answer"
        >
          <div class="flex justify-between items-start mb-3">
            <div class="flex-1">
              <p class="text-xs font-medium text-slate-500 mb-1">GG0170C. Walk 10 Feet</p>
              <p class="text-sm font-semibold text-slate-900">04 - Supervision</p>
            </div>
            <span class="text-xs font-medium text-emerald-600">88%</span>
          </div>

          <p class="text-xs text-slate-600 mb-3 leading-relaxed">
            Uses rolling walker, requires contact guard assistance
          </p>

          <div
            class="flex items-center justify-between text-xs mb-3 pb-3 border-b border-slate-100"
          >
            <span class="text-slate-500">Mobility</span>
            <span class="text-slate-500">ðŸ“‹ Visit Note</span>
          </div>

          <div class="flex space-x-2">
            <button
              (click)="
                acceptRecommendation(
                  $event,
                  'GG0170C',
                  '04 - Supervision or touching assistance',
                  false,
                  10
                )
              "
              class="flex-1 bg-indigo-600 hover:bg-indigo-700 text-white text-xs font-medium py-2 rounded-lg transition-colors"
            >
              Accept
            </button>
            <button
              (click)="rejectRecommendation($event)"
              class="px-3 text-slate-400 hover:text-slate-600 text-xs font-medium transition-colors"
            >
              Reject
            </button>
          </div>
        </div>

        <!-- GG Mobility - Walk 50 feet -->
        <div
          class="recommendation-card border border-slate-200 bg-white rounded-xl p-4 cursor-pointer hover:border-slate-300 hover:shadow-sm transition-all"
          (click)="selectRecommendation($event, 'GG0170D', 'visit-doc')"
          data-form-id="GG0170D-select"
        >
          <div class="flex justify-between items-start mb-3">
            <div class="flex-1">
              <p class="text-xs font-medium text-slate-500 mb-1">GG0170D. Walk 50 Feet</p>
              <p class="text-sm font-semibold text-slate-900">03 - Partial assistance</p>
            </div>
            <span class="text-xs font-medium text-yellow-600">68%</span>
          </div>

          <p class="text-xs text-slate-600 mb-3 leading-relaxed">
            Patient fatigues with longer distances, needs physical support
          </p>

          <div
            class="flex items-center justify-between text-xs mb-3 pb-3 border-b border-slate-100"
          >
            <span class="text-slate-500">Mobility</span>
            <span class="text-slate-500">ðŸ“‹ Visit Note</span>
          </div>

          <div class="flex space-x-2">
            <button
              (click)="acceptGGRecommendation($event, 'GG0170D', '03')"
              class="flex-1 bg-indigo-600 hover:bg-indigo-700 text-white text-xs font-medium py-2 rounded-lg transition-colors"
            >
              Accept
            </button>
            <button
              (click)="rejectRecommendation($event)"
              class="px-3 text-slate-400 hover:text-slate-600 text-xs font-medium transition-colors"
            >
              Reject
            </button>
          </div>
        </div>
      </div>
    </aside>

    <!-- CENTER COLUMN (Document Viewer) -->
    <section class="col-span-6 border-r bg-white">
      <div class="border-b px-6 py-3 flex space-x-4">
        <button
          class="doc-tab active"
          data-doc-id="discharge-doc"
          (click)="switchDocumentTab($any($event.target), 'discharge-doc')"
        >
          Discharge Summary
        </button>

        <button
          class="doc-tab"
          data-doc-id="progress-doc"
          (click)="switchDocumentTab($any($event.target), 'progress-doc')"
        >
          Progress Note
        </button>
      </div>

      <div id="document-viewer" class="overflow-y-auto h-[calc(100%-73px)] p-6 bg-slate-50">
        <!-- DOC 1 -->
        <div id="discharge-doc" class="document-content space-y-6">
          <div
            class="pdf-page bg-white shadow-lg mx-auto p-12 border border-slate-300"
            style="width: 8.5in; min-height: 11in"
          >
            <div class="text-xs text-slate-400 mb-6 text-right">Page 1 of 2</div>
            <h3 class="font-bold text-xl mb-1">Community Hospital</h3>
            <p class="text-xs text-slate-600">Discharge summary content...</p>

            <p class="mt-4 text-sm">
              Patient suffered from
              <span data-evidence-for="I8000" class="evidence-highlight" data-category="diagnosis">
                Acute renal failure (AKI)
              </span>
            </p>
          </div>
        </div>

        <!-- DOC 2 -->
        <div id="progress-doc" class="document-content hidden">
          <div
            class="pdf-page bg-white shadow-lg mx-auto p-12 border border-slate-300"
            style="width: 8.5in; min-height: 11in"
          >
            <div class="text-xs mb-6">Progress Note...</div>
          </div>
        </div>
      </div>
    </section>

    <!-- RIGHT COLUMN (OASIS Form) -->
    <section class="col-span-3 p-6 bg-white overflow-y-auto">
      <h2 class="text-base font-semibold text-slate-900 mb-4">OASIS Form</h2>

      <div class="space-y-4">
        <div class="border p-4 rounded-lg">
          <p class="text-sm font-medium">I8000 â€“ Diagnoses</p>
          <input
            id="I8000-field"
            type="text"
            class="mt-2 w-full px-3 py-2 border rounded-md"
            placeholder="Enter ICD-10"
          />
        </div>
      </div>
    </section>
  </main>
</div>

<!-- UPLOAD MODAL -->
<div
  id="upload-modal"
  class="hidden fixed inset-0 bg-black bg-opacity-40 z-50 items-center justify-center"
>
  <div class="bg-white p-8 rounded-xl shadow-xl w-[420px]">
    <h2 class="text-xl font-bold text-slate-900 mb-4">Upload Patient Documents</h2>

    <div class="border border-dashed p-6 rounded-lg text-center">
      <ion-icon name="cloud-upload-outline" class="text-3xl text-slate-500"></ion-icon>
      <p class="text-sm text-slate-500 mt-2">Drop files or click to upload</p>
    </div>

    <div class="flex justify-end space-x-3 mt-6">
      <button
        class="px-4 py-2 text-slate-600 hover:text-slate-800"
        (click)="hideModal('upload-modal')"
      >
        Cancel
      </button>

      <button class="px-4 py-2 bg-indigo-600 text-white rounded" (click)="startAIProcessing()">
        Process
      </button>
    </div>
  </div>
</div>

<!-- ELIGIBILITY MODAL -->
<div
  id="eligibility-modal"
  class="hidden fixed inset-0 bg-slate-900 bg-opacity-50 items-center justify-center z-50"
>
  <div class="bg-white rounded-2xl p-6 max-w-lg w-full mx-4 shadow-2xl">
    <div class="flex items-center justify-between mb-4">
      <div class="flex items-center space-x-3">
        <div class="w-10 h-10 bg-emerald-100 rounded-full flex items-center justify-center">
          <ion-icon name="shield-checkmark" class="text-2xl text-emerald-600"></ion-icon>
        </div>
        <h2 class="text-lg font-semibold text-slate-900">Eligibility Verified</h2>
      </div>
      <button (click)="hideModal('eligibility-modal')" class="text-slate-400 hover:text-slate-600">
        <ion-icon name="close" class="text-2xl"></ion-icon>
      </button>
    </div>

    <div class="space-y-4 mb-6">
      <!-- Patient Info -->
      <div class="bg-slate-50 rounded-lg p-4">
        <p class="text-xs text-slate-500 uppercase tracking-wide mb-2">Patient Information</p>
        <div class="grid grid-cols-2 gap-3 text-sm">
          <div>
            <p class="text-xs text-slate-500">Name</p>
            <p class="font-semibold text-slate-900">Maria Garcia</p>
          </div>
          <div>
            <p class="text-xs text-slate-500">MRN</p>
            <p class="font-semibold text-slate-900">98765</p>
          </div>
          <div>
            <p class="text-xs text-slate-500">DOB</p>
            <p class="font-semibold text-slate-900">05/12/1948</p>
          </div>
          <div>
            <p class="text-xs text-slate-500">Age</p>
            <p class="font-semibold text-slate-900">76 years</p>
          </div>
        </div>
      </div>

      <!-- Medicare Status -->
      <div class="bg-emerald-50 rounded-lg p-4 border-l-4 border-emerald-500">
        <p class="text-xs text-emerald-700 uppercase tracking-wide mb-2 font-semibold">
          Medicare Status: Active
        </p>
        <div class="space-y-2 text-sm">
          <div class="flex items-center justify-between">
            <span class="text-slate-700">Part A (Hospital Insurance)</span>
            <span class="flex items-center text-emerald-700 font-medium">
              <ion-icon name="checkmark-circle" class="mr-1"></ion-icon>
              Active
            </span>
          </div>
          <div class="flex items-center justify-between">
            <span class="text-slate-700">Part B (Medical Insurance)</span>
            <span class="flex items-center text-emerald-700 font-medium">
              <ion-icon name="checkmark-circle" class="mr-1"></ion-icon>
              Active
            </span>
          </div>
          <div class="text-xs text-slate-600 mt-2 pt-2 border-t border-emerald-200">
            Effective: 01/01/2025 - 12/31/2025
          </div>
        </div>
      </div>

      <!-- Home Health Benefit -->
      <div class="bg-blue-50 rounded-lg p-4 border-l-4 border-blue-500">
        <p class="text-xs text-blue-700 uppercase tracking-wide mb-2 font-semibold">
          Home Health Benefit
        </p>
        <div class="space-y-2 text-sm">
          <div class="flex items-center">
            <ion-icon name="checkmark-circle" class="text-emerald-600 mr-2"></ion-icon>
            <span class="text-slate-700">Available</span>
          </div>
          <div class="flex items-center">
            <ion-icon name="checkmark-circle" class="text-emerald-600 mr-2"></ion-icon>
            <span class="text-slate-700">No prior authorization required</span>
          </div>
          <div class="flex items-center">
            <ion-icon name="checkmark-circle" class="text-emerald-600 mr-2"></ion-icon>
            <span class="text-slate-700"
              >Estimated remaining benefit days: <strong>60</strong></span
            >
          </div>
        </div>
      </div>

      <!-- Verification Details -->
      <div class="text-xs text-slate-500 text-center pt-2">
        <p>Last verified: Just now â€¢ Source: CMS Medicare Portal</p>
      </div>
    </div>

    <div class="flex space-x-3">
      <button
        (click)="hideModal('eligibility-modal')"
        class="flex-1 bg-emerald-600 hover:bg-emerald-700 text-white font-medium py-2.5 rounded-lg transition-colors"
      >
        Continue with Assessment
      </button>
      <button
        (click)="recheckEligibility($event)"
        class="px-4 text-emerald-600 hover:text-emerald-700 border border-emerald-600 hover:border-emerald-700 font-medium rounded-lg transition-colors flex items-center"
      >
        <ion-icon name="refresh-outline" class="mr-1"></ion-icon>
        Re-check
      </button>
    </div>
  </div>
</div>

<!-- EXPORT MODAL -->
<div
  id="export-modal"
  class="hidden fixed inset-0 bg-black bg-opacity-40 z-50 items-center justify-center"
>
  <div class="bg-white p-8 rounded-xl shadow-xl w-[420px]">
    <h2 class="text-xl font-bold mb-4">Export Assessment</h2>

    <p class="text-sm mb-4">Export OASIS XML file?</p>

    <div class="flex justify-end space-x-3">
      <button class="px-4 py-2 text-slate-600" (click)="hideModal('export-modal')">Cancel</button>
      <button class="px-4 py-2 bg-emerald-600 text-white rounded" (click)="exportToXML()">
        Export
      </button>
    </div>
  </div>
</div>

<!-- PROCESSING OVERLAY -->
<div
  id="processing-overlay"
  class="hidden fixed inset-0 bg-slate-900 bg-opacity-90 text-white flex items-center justify-center"
>
  <div class="text-center">
    <div
      class="animate-spin h-16 w-16 border-4 border-white border-t-transparent rounded-full mx-auto"
    ></div>
    <h2 class="text-3xl font-bold mt-8">LANCE AI is Analyzing.</h2>
    <p class="text-slate-300 mt-2">Processing documents...</p>
  </div>
</div>
